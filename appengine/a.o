============================================
Checking folder ./flexible/hello_world
============================================

---- Differences for ./flexible/hello_world/main.py
    --- ./flexible/hello_world/main.py
    +++ ./flexible_python37_and_earlier/hello_world/main.py
    @@ -1,4 +1,4 @@
    -# Copyright 2015 Google LLC
    +# Copyright 2015 Google LLC.
     #
     # Licensed under the Apache License, Version 2.0 (the "License");
     # you may not use this file except in compliance with the License.
    @@ -20,7 +20,7 @@
    
    
     @app.route('/')
    -def hello() -> str:
    +def hello():
         """Return a friendly HTTP greeting."""
         return 'Hello World!'
    
---- Differences for ./flexible/hello_world/main_test.py
    --- ./flexible/hello_world/main_test.py
    +++ ./flexible_python37_and_earlier/hello_world/main_test.py
    @@ -1,4 +1,4 @@
    -# Copyright 2015 Google LLC
    +# Copyright 2015 Google LLC.
     #
     # Licensed under the Apache License, Version 2.0 (the "License");
     # you may not use this file except in compliance with the License.
    @@ -15,7 +15,7 @@
     import main
    
    
    -def test_index() -> str:
    +def test_index():
         main.app.testing = True
         client = main.app.test_client()
    
============================================
Checking folder ./flexible/storage
============================================

---- Differences for ./flexible/storage/main.py
    --- ./flexible/storage/main.py
    +++ ./flexible_python37_and_earlier/storage/main.py
    @@ -1,4 +1,4 @@
    -# Copyright 2015 Google LLC
    +# Copyright 2015 Google LLC.
     #
     # Licensed under the Apache License, Version 2.0 (the "License");
     # you may not use this file except in compliance with the License.
    @@ -23,10 +23,10 @@
     app = Flask(__name__)
    
     # Configure this environment variable via app.yaml
    -CLOUD_STORAGE_BUCKET = os.environ["CLOUD_STORAGE_BUCKET"]
    +CLOUD_STORAGE_BUCKET = os.environ['CLOUD_STORAGE_BUCKET']
    
    
    -@app.route("/")
    +@app.route('/')
     def index() -> str:
         return """
     <form method="POST" action="/upload" enctype="multipart/form-data">
    @@ -36,13 +36,13 @@
     """
    
    
    -@app.route("/upload", methods=["POST"])
    +@app.route('/upload', methods=['POST'])
     def upload() -> str:
         """Process the uploaded file and upload it to Google Cloud Storage."""
    -    uploaded_file = request.files.get("file")
    +    uploaded_file = request.files.get('file')
    
         if not uploaded_file:
    -        return "No file uploaded.", 400
    +        return 'No file uploaded.', 400
    
         # Create a Cloud Storage client.
         gcs = storage.Client()
    @@ -54,7 +54,8 @@
         blob = bucket.blob(uploaded_file.filename)
    
         blob.upload_from_string(
    -        uploaded_file.read(), content_type=uploaded_file.content_type
    +        uploaded_file.read(),
    +        content_type=uploaded_file.content_type
         )
    
         # Make the blob public. This is not necessary if the
    @@ -68,20 +69,15 @@
    
     @app.errorhandler(500)
     def server_error(e: Union[Exception, int]) -> str:
    -    logging.exception("An error occurred during a request.")
    -    return (
    -        """
    +    logging.exception('An error occurred during a request.')
    +    return """
         An internal error occurred: <pre>{}</pre>
         See logs for full stacktrace.
    -    """.format(
    -            e
    -        ),
    -        500,
    -    )
    +    """.format(e), 500
    
    
    -if __name__ == "__main__":
    +if __name__ == '__main__':
         # This is used when running locally. Gunicorn is used to run the
         # application on Google App Engine. See entrypoint in app.yaml.
    -    app.run(host="127.0.0.1", port=8080, debug=True)
    +    app.run(host='127.0.0.1', port=8080, debug=True)
     # [END gae_flex_storage_app]

---- Differences for ./flexible/storage/main_test.py
    --- ./flexible/storage/main_test.py
    +++ ./flexible_python37_and_earlier/storage/main_test.py
    @@ -1,4 +1,4 @@
    -# Copyright 2015 Google LLC
    +# Copyright 2015 Google LLC.
     #
     # Licensed under the Apache License, Version 2.0 (the "License");
     # you may not use this file except in compliance with the License.
    @@ -12,7 +12,6 @@
     # See the License for the specific language governing permissions and
     # limitations under the License.
    
    -import io
     import os
     import uuid
    
    @@ -20,8 +19,8 @@
     import flask.testing
     from google.cloud import storage
     import pytest
    -
     import requests
    +from six import BytesIO
    
     import main
    
    @@ -33,7 +32,7 @@
    
    
     def test_index(client: flask.testing.FlaskClient) -> None:
    -    r = client.get("/")
    +    r = client.get('/')
         assert r.status_code == 200
    
    
    @@ -51,12 +50,17 @@
         # Upload a simple file
         file_content = b"This is some test content."
    
    -    r = client.post("/upload", data={"file": (io.BytesIO(file_content), blob_name)})
    +    r = client.post(
    +        '/upload',
    +        data={
    +            'file': (BytesIO(file_content), blob_name)
    +        }
    +    )
    
         assert r.status_code == 200
    
         # The app should return the public cloud storage URL for the uploaded
         # file. Download and verify it.
    -    cloud_storage_url = r.data.decode("utf-8")
    +    cloud_storage_url = r.data.decode('utf-8')
         r = requests.get(cloud_storage_url)
    -    assert r.text.encode("utf-8") == file_content
    +    assert r.text.encode('utf-8') == file_content
